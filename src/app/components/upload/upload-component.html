<div class="upload-container">
  <div class="upload-header">
    <h2>üì§ T√©l√©chargement de Documents</h2>
    <p>Formats accept√©s: PDF, DOCX, TXT</p>
  </div>

  <!-- Upload Zone -->
  <div 
    class="upload-zone"
    [class.drag-over]="isDragOver()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
    (click)="onUploadZoneClick()"
  >
    <div class="upload-content">
      <div class="upload-icon">üìÅ</div>
      <h3>Glissez-d√©posez vos fichiers ici</h3>
      <p>ou cliquez pour s√©lectionner</p>
      <div class="supported-formats">
        <span class="format-badge">PDF</span>
        <span class="format-badge">DOCX</span>
        <span class="format-badge">TXT</span>
      </div>
    </div>
  </div>

  <!-- Hidden File Input -->
  <input
    #fileInput
    type="file"
    multiple
    accept=".pdf,.docx,.doc,.txt"
    (change)="onFileSelect($event)"
    style="display: none;"
  />

  <!-- Uploaded Files List -->
  @if (uploadedFiles().length > 0) {
    <div class="files-section">
      <div class="files-header">
        <h3>üìã Fichiers t√©l√©charg√©s ({{ uploadedFiles().length }})</h3>
        <div class="header-actions">
          @if (canProcessDocuments()) {
            <button 
              class="process-btn"
              (click)="processDocuments()"
              type="button"
              [disabled]="isProcessing()"
            >
              @if (isProcessing()) {
                üîÑ Traitement en cours...
              } @else {
                ü§ñ Analyser les documents
              }
            </button>
          }
          <button 
            class="clear-all-btn"
            (click)="clearAllFiles()"
            type="button"
          >
            üóëÔ∏è Tout supprimer
          </button>
        </div>
      </div>

      <div class="files-list">
        @for (file of uploadedFiles(); track $index) {
          <div class="file-item" [class]="file.status">
            <div class="file-info">
              <span class="file-icon">{{ getFileIcon(file.file.name) }}</span>
              <div class="file-details">
                <div class="file-name">{{ file.file.name }}</div>
                <div class="file-size">{{ formatFileSize(file.file.size) }}</div>
                @if (file.id) {
                  <div class="file-id">ID: {{ file.id }}</div>
                }
              </div>
            </div>

            <div class="file-status">
              @switch (file.status) {
                @case ('uploading') {
                  <div class="progress-container">
                    <div class="progress-bar">
                      <div 
                        class="progress-fill" 
                        [style.width.%]="file.progress"
                      ></div>
                    </div>
                    <span class="progress-text">{{ file.progress }}%</span>
                  </div>
                }
                @case ('success') {
                  <div class="status-success">
                    <span class="status-icon">‚úÖ</span>
                    <span>T√©l√©charg√©</span>
                  </div>
                }
                @case ('processing') {
                  <div class="status-processing">
                    <span class="status-icon">üîÑ</span>
                    <span>Traitement...</span>
                  </div>
                }
                @case ('processed') {
                  <div class="status-processed">
                    <span class="status-icon">ü§ñ</span>
                    <span>Analys√©</span>
                  </div>
                }
                @case ('error') {
                  <div class="status-error">
                    <span class="status-icon">‚ùå</span>
                    <span>{{ file.errorMessage || 'Erreur' }}</span>
                  </div>
                }
              }
            </div>

            <button 
              class="remove-btn"
              (click)="removeFile($index)"
              type="button"
              title="Supprimer le fichier"
            >
              ‚úï
            </button>
          </div>
        }
      </div>

      <!-- Summary -->
      @if (getSuccessfulUploads().length > 0) {
        <div class="upload-summary">
          <div class="summary-item">
            <span class="summary-label">Fichiers r√©ussis:</span>
            <span class="summary-value">{{ getSuccessfulUploads().length }}</span>
          </div>
          @if (getProcessedFiles().length > 0) {
            <div class="summary-item">
              <span class="summary-label">Fichiers analys√©s:</span>
              <span class="summary-value success">{{ getProcessedFiles().length }}</span>
            </div>
          }
          <div class="summary-item">
            <span class="summary-label">Pr√™t pour traitement:</span>
            <span class="summary-value success">‚úÖ</span>
          </div>
        </div>
      }
    </div>
  }

  <!-- Analysis Results -->
  @if (analysisResult()) {
    <div class="analysis-section">
      <div class="analysis-header">
        <h3>ü§ñ R√©sultats de l'analyse</h3>
      </div>
      <div class="analysis-content">
        <pre>{{ analysisResult() }}</pre>
      </div>
    </div>
  }
</div>